Optimized _Legionella_ expression strain for affinity purification of His-tagged membrane proteins eliminates major multimeric contaminant
Sukhithasri Vijayrajratnam1, Jonasz B. Patkowski2, Joshua Khorsandi3, Wandy L. Beatty1, Shanmugapriya Kannaiah1, Ahmet Hasanovic1, Tamara J. O’Connor3, Tiago R.D. Costa2, Joseph P. Vogel1*

1Department of Molecular Microbiology, Washington University, St. Louis, MO 63110.9
2Centre for Bacterial Resistance Biology, Imperial College London, London, UK. 
3Department of Biological Chemistry, The Johns Hopkins University School of Medicine, Baltimore, Maryland, USA

*Corresponding author

This README file contains provides instructions to execute customs scripts and data analysis to determine the frequency of histidines residues in the Legionella pneumophila Philadelphia-1 proteome. 

Contents
`data/`: Contains input sequence files.
`src/`: Includes scripts for processing data and generating figures.
`out/`: Output directory for generated data

Software Requirements: Python 3.7+ and R 4.4.2. 

Usage
First install the required packages:
```sh
pip install pandas seaborn biopython 
```
The required data files are
1. `EColiK12_protein_NCBI.faa`: Protein sequences from E. coli K12.
2. `lpg1596.fasta`: Fasta file for the lpg1596 sequence.
3. `ncbi_Lp_protein.faa`: Protein sequences from *L. pneumophila*.
4. `NCBI_Lp02_annotations.gff`: Annotations for the Lp02 genome.

Description of the src files
1. `hist_composition.ipynb`, calculate the per ORF histidine composition for a given sequence file using Biopython.
2. `sliding_window.R` calculates a 6 amino acid sliding window over the *L. pneumophila* genome which counts the number of histidine residues. Separate files for lpg1596 and the whole genome.
3. `Lp02_AA_location.R`, plots a 12 gene sliding window over the Lp02 genome aggregating histidine frequency. Uses GenomicRanges to parse seqeunnce data and the GViz package to visualize histidine annotations. 

To generate figures from the data in the output directory run
```bash
python figures.py
```
Description of Output files

The `out/` directory contains all output data generated by the scripts, the `plots/` directory holds all generated figures.

1. Lp02_rollingmax_ORFs.csv, 12 gene rolling max of histidine frequencies over the *L. pneumophila* genome
2. Lp02_rollingmean_ORFs.csv, 12 gene rolling max of histidine frequencies over the *L. pneumophila* genome.
3. NCBI_K12_histFreq.csv, histidine frequency per ORF for the *E.Coli* K12 genome. 
4. NCBI_Lp_histFreq.csv, histidine frequency per ORF for the *L. pneumophila*  genome.
5. sliding_window_1596.csv, 6 amino acid sliding window over the 1596 amino acid sequence. 
6. sliding_window_ORF, 6 amino acid sliding window over the *L. pneumophila* genome. 

References

1. Lawrence M, Huber W, Pagès H, Aboyoun P, Carlson M, et al. (2013) Software for Computing and Annotating Genomic Ranges. PLoS Comput Biol 9(8): e1003118.
2. Hahne F, Ivanek R. Visualizing Genomic Data Using Gviz and Bioconductor. Methods Mol Biol. 1418:335-51 (2016).

